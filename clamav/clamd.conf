# ClamAV daemon configuration
# Custom configuration to allow scanning large files via INSTREAM

# Maximum size of files to be scanned via INSTREAM protocol
# Set to 500M to allow files up to 500MB (adjust based on your needs)
# Value of 0 disables the limit (not recommended for security)
StreamMaxLength 500M

# Maximum size of files to be scanned
# Set to 500M to match StreamMaxLength
MaxFileSize 500M

# Maximum size of files to be scanned with PCRE regex
PCREMaxFileSize 500M

# TCP port for clamd
TCPSocket 3310

# TCP address to bind to (0.0.0.0 = all interfaces)
TCPAddr 0.0.0.0

# Maximum number of connections
MaxConnectionQueueLength 200

# Self-check interval (in seconds)
SelfCheck 600

# Log file (removed /dev/stdout to avoid symbolic link loop)
# Logs will go to stderr/stdout automatically in Docker

# Log verbose
LogVerbose yes

# Log time
LogTime yes

# Pid file
PidFile /run/clamav/clamd.pid

# Temporary directory
TemporaryDirectory /tmp

# Database directory
DatabaseDirectory /var/lib/clamav

# Allow local connections
LocalSocket /run/clamav/clamd.sock
